<?php
/**
 * TripSalama - Dashboard Passagère
 * Design System φ "Moroccan Luxury"
 */
?>

<!-- Welcome Card -->
<section class="welcome-card section" style="animation-delay: 0.05s;">
    <div class="welcome-content">
        <p class="welcome-eyebrow"><?= __('auth.welcome_back') ?></p>
        <h1 class="welcome-title"><?= htmlspecialchars($user['first_name']) ?> !</h1>
        <p class="welcome-subtitle">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/>
                <circle cx="12" cy="10" r="3"/>
            </svg>
            <?= __('app.tagline') ?>
        </p>
    </div>
</section>

<!-- Stats Grid -->
<section class="stats-grid section-tight">
    <div class="stat-card">
        <div class="stat-value"><?= $stats['total_rides'] ?? 0 ?></div>
        <div class="stat-label"><?= __('history.total_rides') ?></div>
    </div>
    <div class="stat-card">
        <div class="stat-value"><?= $stats['this_month'] ?? 0 ?></div>
        <div class="stat-label"><?= __('history.this_month') ?></div>
    </div>
</section>

<?php if ($activeRide): ?>
<!-- Active Ride Card -->
<section class="card section" style="animation-delay: 0.15s;">
    <div class="card-header flex justify-between items-center">
        <h3 class="text-title"><?= __('ride.title') ?></h3>
        <span class="badge badge-<?= $activeRide['status'] === 'in_progress' ? 'success' : 'warning' ?>">
            <?= __('ride.' . $activeRide['status']) ?>
        </span>
    </div>
    <div class="card-body-compact">
        <div class="flex flex-col gap-3 mb-4">
            <div class="flex items-center gap-3">
                <span class="address-dot pickup" style="position:static;"></span>
                <span class="text-body"><?= htmlspecialchars($activeRide['pickup_address']) ?></span>
            </div>
            <div class="flex items-center gap-3">
                <span class="address-dot dropoff" style="position:static;"></span>
                <span class="text-body"><?= htmlspecialchars($activeRide['dropoff_address']) ?></span>
            </div>
        </div>
        <a href="<?= base_url('passenger/ride/' . $activeRide['id']) ?>" class="btn btn-primary btn-block">
            <?= __('ride.title') ?>
        </a>
    </div>
</section>
<?php endif; ?>

<!-- Quick Actions -->
<section class="section">
    <h2 class="text-overline mb-3"><?= __('nav.home') ?></h2>

    <div class="action-list">
        <a href="<?= base_url('passenger/book') ?>" class="action-item">
            <div class="action-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="16"/>
                    <line x1="8" y1="12" x2="16" y2="12"/>
                </svg>
            </div>
            <div class="action-content">
                <div class="action-title"><?= __('booking.title') ?></div>
                <div class="action-subtitle"><?= __('booking.pickup_placeholder') ?></div>
            </div>
            <svg class="action-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"/>
            </svg>
        </a>

        <a href="<?= base_url('passenger/history') ?>" class="action-item">
            <div class="action-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12,6 12,12 16,14"/>
                </svg>
            </div>
            <div class="action-content">
                <div class="action-title"><?= __('history.title') ?></div>
                <div class="action-subtitle"><?= __('history.view_details') ?></div>
            </div>
            <svg class="action-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"/>
            </svg>
        </a>

        <a href="<?= base_url('profile') ?>" class="action-item">
            <div class="action-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
            </div>
            <div class="action-content">
                <div class="action-title"><?= __('profile.title') ?></div>
                <div class="action-subtitle"><?= __('profile.edit') ?></div>
            </div>
            <svg class="action-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"/>
            </svg>
        </a>
    </div>
</section>
