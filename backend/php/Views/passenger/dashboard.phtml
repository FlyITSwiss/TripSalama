<?php
/**
 * TripSalama - Dashboard Passager
 * Design Uber Premium
 */
?>

<style>
    .uber-dashboard {
        padding: var(--space-4);
        padding-bottom: calc(var(--nav-height) + var(--space-8));
    }

    /* Welcome Section */
    .uber-welcome {
        margin-bottom: var(--space-6);
    }

    .uber-welcome-greeting {
        font-size: var(--text-sm);
        color: var(--uber-gray-500);
        margin-bottom: var(--space-1);
    }

    .uber-welcome-name {
        font-size: var(--text-3xl);
        font-weight: var(--font-bold);
        color: var(--uber-black);
        letter-spacing: -0.02em;
    }

    /* Where To Card - Main CTA */
    .where-to-card {
        background: var(--uber-white);
        border-radius: var(--radius-2xl);
        padding: var(--space-4);
        box-shadow: var(--shadow-lg);
        margin-bottom: var(--space-6);
    }

    .where-to-input {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        padding: var(--space-4);
        background: var(--uber-gray-100);
        border-radius: var(--radius-xl);
        cursor: pointer;
        transition: all 0.2s ease;
        text-decoration: none;
        color: inherit;
    }

    .where-to-input:hover {
        background: var(--uber-gray-200);
    }

    .where-to-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--uber-black);
        border-radius: var(--radius-lg);
    }

    .where-to-icon svg {
        width: 16px;
        height: 16px;
        color: var(--uber-white);
    }

    .where-to-text {
        flex: 1;
        font-size: var(--text-lg);
        font-weight: var(--font-medium);
        color: var(--uber-gray-500);
    }

    .where-to-arrow {
        width: 20px;
        height: 20px;
        color: var(--uber-gray-400);
    }

    /* Stats */
    .uber-stats {
        display: flex;
        gap: var(--space-3);
        margin-bottom: var(--space-6);
    }

    .uber-stat {
        flex: 1;
        background: var(--uber-white);
        border-radius: var(--radius-xl);
        padding: var(--space-4);
        text-align: center;
        box-shadow: var(--shadow-sm);
    }

    .uber-stat-value {
        font-size: var(--text-3xl);
        font-weight: var(--font-bold);
        color: var(--uber-black);
        line-height: 1;
        margin-bottom: var(--space-1);
    }

    .uber-stat-label {
        font-size: var(--text-xs);
        color: var(--uber-gray-500);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    /* Active Ride Card */
    .active-ride-card {
        background: var(--uber-black);
        border-radius: var(--radius-2xl);
        padding: var(--space-5);
        margin-bottom: var(--space-6);
        color: var(--uber-white);
    }

    .active-ride-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-4);
    }

    .active-ride-title {
        font-size: var(--text-lg);
        font-weight: var(--font-semibold);
    }

    .active-ride-status {
        padding: var(--space-1) var(--space-3);
        background: var(--uber-green);
        border-radius: var(--radius-full);
        font-size: var(--text-xs);
        font-weight: var(--font-semibold);
        text-transform: uppercase;
    }

    .active-ride-route {
        display: flex;
        gap: var(--space-3);
        margin-bottom: var(--space-4);
    }

    .active-ride-dots {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0;
        padding: var(--space-1) 0;
    }

    .active-ride-dot {
        width: 10px;
        height: 10px;
        border-radius: var(--radius-full);
        background: var(--uber-white);
    }

    .active-ride-line {
        width: 2px;
        height: 24px;
        background: var(--uber-gray-600);
    }

    .active-ride-addresses {
        flex: 1;
    }

    .active-ride-address {
        font-size: var(--text-sm);
        color: var(--uber-gray-300);
        margin-bottom: var(--space-3);
    }

    .active-ride-address:last-child {
        margin-bottom: 0;
    }

    .active-ride-btn {
        width: 100%;
        padding: var(--space-4);
        background: var(--uber-white);
        color: var(--uber-black);
        border: none;
        border-radius: var(--radius-lg);
        font-size: var(--text-base);
        font-weight: var(--font-semibold);
        cursor: pointer;
        text-decoration: none;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        transition: all 0.2s ease;
    }

    .active-ride-btn:hover {
        background: var(--uber-gray-100);
    }

    .active-ride-btn svg {
        width: 20px;
        height: 20px;
    }

    /* Animation */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .uber-welcome { animation: fadeInUp 0.4s ease-out; }
    .where-to-card { animation: fadeInUp 0.4s ease-out 0.05s backwards; }
    .uber-stats { animation: fadeInUp 0.4s ease-out 0.1s backwards; }
    .active-ride-card { animation: fadeInUp 0.4s ease-out 0.15s backwards; }
</style>

<div class="uber-dashboard">
    <!-- Welcome -->
    <section class="uber-welcome">
        <p class="uber-welcome-greeting"><?= __('auth.welcome_back') ?></p>
        <h1 class="uber-welcome-name"><?= htmlspecialchars($user['first_name']) ?></h1>
    </section>

    <!-- Where To Card -->
    <section class="where-to-card">
        <a href="<?= base_url('passenger/book') ?>" class="where-to-input">
            <div class="where-to-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                </svg>
            </div>
            <span class="where-to-text"><?= __('booking.pickup_placeholder') ?></span>
            <svg class="where-to-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"/>
            </svg>
        </a>
    </section>

    <!-- Stats -->
    <section class="uber-stats">
        <div class="uber-stat">
            <div class="uber-stat-value"><?= $stats['total_rides'] ?? 0 ?></div>
            <div class="uber-stat-label"><?= __('history.total_rides') ?></div>
        </div>
        <div class="uber-stat">
            <div class="uber-stat-value"><?= $stats['this_month'] ?? 0 ?></div>
            <div class="uber-stat-label"><?= __('history.this_month') ?></div>
        </div>
    </section>

    <?php if ($activeRide): ?>
    <!-- Active Ride -->
    <section class="active-ride-card">
        <div class="active-ride-header">
            <span class="active-ride-title"><?= __('ride.title') ?></span>
            <span class="active-ride-status"><?= __('ride.' . $activeRide['status']) ?></span>
        </div>
        <div class="active-ride-route">
            <div class="active-ride-dots">
                <div class="active-ride-dot"></div>
                <div class="active-ride-line"></div>
                <div class="active-ride-dot" style="background: transparent; border: 2px solid var(--uber-white);"></div>
            </div>
            <div class="active-ride-addresses">
                <div class="active-ride-address"><?= htmlspecialchars($activeRide['pickup_address']) ?></div>
                <div class="active-ride-address"><?= htmlspecialchars($activeRide['dropoff_address']) ?></div>
            </div>
        </div>
        <a href="<?= base_url('passenger/ride/' . $activeRide['id']) ?>" class="active-ride-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/>
                <circle cx="12" cy="10" r="3"/>
            </svg>
            <?= __('ride.title') ?>
        </a>
    </section>
    <?php endif; ?>
</div>
